(this.webpackJsonproleterminal=this.webpackJsonproleterminal||[]).push([[0],{27:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWAQMAAAAGz+OhAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAAABlBMVEUAAAAA/+8G9rtUAAAAAXRSTlMAQObYZgAAAfNJREFUSMfl1jtOxDAQBuBYLlz6CDmKb4ZDxbWMKLhGEAVtJAoiEcX4PTP2LKSj2K12P+1m/9gzE0/T/b1mD6+1GCJ/ZJLYfDZNzA2Xqxc0xLZkltg+/G35Y0HtvGU0Xg7ImepsSXbAcohqG1ojk0y39ck36pI5ZPqiqWLL/5ldBpPtnsF0WxuwOS85MVNrApn19c/BWp2ACSi8X0222vnb9s4Ua9+MvTG2MuYu/vbzZpaHMbMIK9TfmwyfewuR6Fpt8d02rN8cLtqvvQk7SvbIxWY86V4uqRnJnvvceEtXGzGRwzW05yZbUa3Fd3FWbF1NxlmxdxZnxdFZnBVnZ6l7qYV4H94/EQvxXrx/JRbiPcavYgvxwiW/iMU6t6Vgq8XVM53ZcM9zZ3FLNDXh064Rk/GTpKbi8gtqOrUXtdyGlphJ7WqI2VRtM7HcNRqbyB2nsMn8QWJTvn4dTJfux1anhEVmyjQxyGxpkBlZbWoNJupAQHsu6zBBpnzb5WY1HrY2xJDVeGRODv0L8ZCJcV5BPGSKmYmamZ38jD2YGbtP44wd5jjEI7PETeNsGp4LEA8M4oFBPDCI18xBvLa/zxCv2TvEK7WhQn/C48zUaoR4kwfrnvFXzwdXzxvcWYU903BnH+6MxJ2luDMXdzZjz3D39PoBF4cEYKUUl6gAAAAASUVORK5CYII="},30:function(e,t,n){e.exports=n(64)},40:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(10),c=n(1),i=n(2),u=function(e){return e>9?"".concat(e):"0".concat(e)},s=function(e){return e.config.get("requireOffName")},l=function(e){return e.config.get("publicRoomId")},d=function(e){return e.config.get("allowedImages")},m=function(e,t){var n=t.date,r=t.offset,a=t.lockDate,o=new Date(n),c={},i=e.config,s=i.yearModification,l=i.dayModification;return r&&o.setHours(o.getHours()+r),a||Number.isNaN(s)||(s&&!Number.isNaN(s)&&o.setFullYear(o.getFullYear()+parseInt(s,10)),l&&!Number.isNaN(l)&&o.setDate(o.getDate()+parseInt(l,10))),c.mins=u(o.getMinutes()),c.hours=u(o.getHours()),c.seconds=u(o.getSeconds()),c.month=u(o.getMonth()+1),c.day=u(o.getDate()),c.year=o.getFullYear(),c.halfTime="".concat(c.hours,":").concat(c.mins),c.fullTime="".concat(c.halfTime,":").concat(c.seconds),c.halfDate="".concat(c.day,"/").concat(c.month),c.fullDate="".concat(c.halfDate,"/").concat(c.year),c.fullStamp="".concat(c.fullTime," ").concat(c.fullDate),c},f=function(){var e=Object(r.useState)(Date.now()),t=Object(i.a)(e,2),n=t[0],o=t[1],u=Object(c.d)((function(e){return m(e,{date:n})}));return Object(r.useEffect)((function(){!function e(){setTimeout((function(){o(Date.now()),e()}),400)}()}),[]),a.a.createElement("div",{key:"clock",className:"Clock"},a.a.createElement("span",null,u.halfTime))},p=(n(40),a.a.memo((function(e){var t=e.items;return a.a.createElement(a.a.Fragment,null,t)}))),v=function(e){var t=e.children,n=e.title,o=e.scrollTo,c=e.dropdown,u=void 0!==c&&c,s=e.classNames,l=void 0===s?[]:s,d=Object(r.useRef)(null),m=Object(r.useRef)(null),f=Object(r.useState)("undefined"!==typeof n),v=Object(i.a)(f,2),g=v[0],h=v[1],y=[],b=["List"].concat(l);return Object(r.useEffect)((function(){o&&d.current&&"bottom"===o.direction&&d.current.lastElementChild&&d.current.lastElementChild.scrollIntoView()})),g?y.push("hide"):b.push("expanded"),u&&y.push("dropdown"),a.a.createElement("div",{key:"List",className:b.join(" ")},n&&a.a.createElement("header",{role:"button",tabIndex:0,key:"listHeader",className:"toggle clickable",onClick:function(){h(!g)}},n),a.a.createElement("ul",{ref:function(e){d.current=e,e&&(m.current=e.closest(".Window"))},key:"listElem",className:"".concat(y.join(" ")),onClick:function(){u&&(!m.current||m.current.offsetWidth<600)&&h(!0)}},a.a.createElement(p,{items:t})))},g=a.a.memo(v);v.defaultProps={classNames:[],children:void 0,title:void 0,dropdown:!1,scrollTo:void 0};var h=0,y=1,b=4,j=function(e){var t=e.objectToAccess,n=e.toAuth;if(!t||!n)return{canSee:!1,hasFullAccess:!1,hasAccess:!1};var r=t.ownerId,a=t.ownerAliasId,o=t.teamId,c=t.isPublic,i=t.visibility,u=t.teamIds,s=void 0===u?[]:u,l=t.userIds,d=void 0===l?[]:l,m=t.userAdminIds,f=void 0===m?[]:m,p=t.teamAdminIds,v=void 0===p?[]:p,g=n.hasFullAccess,y=n.partOfTeams,j=void 0===y?[]:y,O=n.accessLevel,E=void 0===O?h:O,w=n.objectId,I=n.teamIds,k=void 0===I?[]:I,S=n.aliases,C=void 0===S?[]:S,N=a&&C.includes(a),x=o&&j.includes(o),A=d.concat([r]).includes(w),R=x||s.find((function(e){return k.includes(e)})),T=N||C.find((function(e){return d.includes(e)})),M=f.includes(w),L=N||C.find((function(e){return f.includes(e)})),P=x||v.find((function(e){return k.includes(e)})),D=r===w||g||E>=b;return{canSee:D||c||A||R||T||E>=i,hasAccess:D||c||A||R||T,hasFullAccess:D||M||P||L}},O=n(3),E=n.n(O),w=n(5),I=n(28);n(46);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var C=a.a.createElement("polyline",{points:"15 3 21 3 21 9"}),N=a.a.createElement("polyline",{points:"9 21 3 21 3 15"}),x=a.a.createElement("line",{x1:21,y1:3,x2:14,y2:10}),A=a.a.createElement("line",{x1:3,y1:21,x2:10,y2:14}),R=function(e){var t=e.svgRef,n=e.title,r=S(e,["svgRef","title"]);return a.a.createElement("svg",k({width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-maximize-2",ref:t},r),n?a.a.createElement("title",null,n):null,C,N,x,A)},T=a.a.forwardRef((function(e,t){return a.a.createElement(R,k({svgRef:t},e))}));n.p;function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function L(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var P=a.a.createElement("line",{x1:18,y1:6,x2:6,y2:18}),D=a.a.createElement("line",{x1:6,y1:6,x2:18,y2:18}),W=function(e){var t=e.svgRef,n=e.title,r=L(e,["svgRef","title"]);return a.a.createElement("svg",M({width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-x",ref:t},r),n?a.a.createElement("title",null,n):null,P,D)},F=a.a.forwardRef((function(e,t){return a.a.createElement(W,M({svgRef:t},e))})),U=(n.p,n(47),n(6)),B=(n(48),a.a.forwardRef((function(e,t){var n=e.onClick,r=e.children,o=e.disabled,c=e.stopPropagation,i=e.classNames,u=void 0===i?[""]:i,s=e.type,l=void 0===s?"button":s;return a.a.createElement("button",{ref:t,className:"".concat(["Button"].concat(u).join(" ")),disabled:o,type:l,onClick:function(e){c&&e.stopPropagation(),n(e)}},r)}))),z=B;B.propTypes={onClick:U.func.isRequired,children:U.node.isRequired,type:Object(U.oneOf)(["button","submit"]),disabled:U.bool,classNames:Object(U.arrayOf)(U.string),stopPropagation:U.bool},B.defaultProps={type:"button",disabled:void 0,classNames:[],stopPropagation:void 0};var H=a.a.memo((function(e){var t=e.onDoubleClick,n=e.title,r=e.done;return a.a.createElement("div",{onDoubleClick:t,className:"TopBar"},a.a.createElement("span",{className:"title"},n),a.a.createElement("div",{className:"buttons"},a.a.createElement(z,{type:"button",onClick:t},a.a.createElement(T,null)),a.a.createElement(z,{stopPropagation:!0,type:"button",onClick:r},a.a.createElement(F,null))))})),Z=function(e){var t=e.onClick,n=e.children,o=e.order,c=e.menu,u=e.title,s=void 0===u?"app":u,l=e.classNames,d=void 0===l?[]:l,m=e.done,f=void 0===m?function(){}:m,p={width:640,height:460},v=Object(r.useState)(p),g=Object(i.a)(v,2),h=g[0],y=g[1],b=Object(r.useState)(),j=Object(i.a)(b,2),O=j[0],E=j[1],w=["Window"].concat(d);return a.a.createElement(I.a,{position:O,className:"".concat(["rnd"].join(" ")),style:{zIndex:o},size:h,minWidth:320,minHeight:220,maxHeight:"100%",maxWidth:"100%",bounds:"parent",dragHandleClassName:"TopBar",enableResizing:{top:!1,right:!0,bottom:!0,left:!0,topRight:!1,bottomRight:!0,bottomLeft:!0,topLeft:!1},onDragStart:t,onDragStop:function(e,t){var n=t.node,r=t.x,a=t.y;O&&r===O.x&&a===O.y||(0===r&&0===a&&"100%"!==h.height?(y({width:"50%",height:"50%"}),E({x:0,y:0})):0===r&&a+n.offsetHeight+35>=window.innerHeight&&"100%"!==h.height?(y({width:"50%",height:"50%"}),E({x:0,y:(window.innerHeight-36)/2})):0===a&&r+n.offsetWidth>=window.innerWidth&&"100%"!==h.height?(y({width:"50%",height:"50%"}),E({x:window.innerWidth/2,y:0})):r+n.offsetWidth>=window.innerWidth&&a+n.offsetHeight+35>=window.innerHeight&&"100%"!==h.height?(y({width:"50%",height:"50%"}),E({x:window.innerWidth/2,y:(window.innerHeight-36)/2})):0===r&&a>0?(y({width:"50%",height:"100%"}),E({x:0,y:0})):r+n.offsetWidth>=window.innerWidth&&a>0?(y({width:"50%",height:"100%"}),E({x:window.innerWidth/2,y:0})):E({x:r,y:a}))},onResizeStart:t,onResizeStop:function(e,t,n){y({width:n.offsetWidth,height:n.offsetHeight})}},a.a.createElement("div",{role:"complementary",onClick:t,className:"".concat(w.join(" "))},a.a.createElement(H,{done:f,title:s,onDoubleClick:function(){"100%"===h.width&&"100%"===h.height?y(p):(E({x:0,y:0}),y({width:"100%",height:"100%"}))}}),a.a.createElement("div",{className:"windowBox"},c&&a.a.createElement("div",{className:"menu"},c),a.a.createElement("div",{className:"content"},n))))},G=a.a.memo(Z);Z.defaultProps={done:function(){},classNames:[],title:"app",menu:void 0,order:void 0};n(49);var Y=function(e){var t=e.children,n=e.title,r=e.error,o=e.text,c=e.done,i=e.classNames,u=void 0===i?[]:i;return a.a.createElement(G,{done:c,order:10,title:n,classNames:["Dialog"].concat(u),onClick:function(){}},a.a.createElement("div",{className:"inputs"},r&&a.a.createElement("div",null,r.type),o&&a.a.createElement("div",null,o),t))},J=a.a.memo(Y);Y.defaultProps={children:void 0,error:void 0,title:void 0,text:void 0,classNames:[]};var q=n(12),V=n(26),X="aliases",Q="devices",K="docFiles",$="forums",_="forumPosts",ee="forumThreads",te="gameCodes",ne="invitations",re="messages",ae="rooms",oe="simpleMsgs",ce="teams",ie="transactions",ue="users",se="wallets",le=n(4),de="update",me="create",fe="remove",pe=function(e,t){var n=new Map(Object(le.a)(e)),r=t.type,a=t.payload,o=a.changeType,c=a[r];switch(o){case me:return n.set(c.objectId,c),n;case de:var i=n[c.objectId],u=Object.assign(i||{},c);return i===u?e:(n.set(c.objectId,u),n);case fe:return n.has(c.objectId)?(n.delete(c.objectId),n):e;default:return e}},ve=function(e,t){var n=t.type,r=t.payload,a=r.reset,o=r.changeType,c=a?new Map:new Map(Object(le.a)(e)),i=r[n];switch(o){case me:return i.forEach((function(e){return c.set(e.objectId,e)})),c;case de:return i.forEach((function(e){var t=c[e.objectId],n=Object.assign(t||{},e);t!==n&&c.set(e.objectId,n)})),c;case fe:return i.forEach((function(e){return c.delete(e.objectId)})),c;default:return e}};var ge="online",he="offline",ye="reconnecting";var be=new Map;be.set("broadcastId","111111111111111111111116"),be.set("publicRoomId","111111111111111111111110"),be.set("defaultForum","111111111111111111111120"),be.set("defaultLanguage","en"),be.set("centerCoordinates",{longitude:0,latitude:0}),be.set("cornerOneCoordinates",{longitude:0,latitude:0}),be.set("cornerTwoCoordinates",{longitude:0,latitude:0}),be.set("defaultZoomLevel",15),be.set("yearModification",0),be.set("dayModification",0),be.set("requireOffName",!1),be.set("activateTermination",!1),be.set("allowedImages",{CHAT:!1,PROFILE:!1,DOCFILE:!1}),be.set("permissions",{}),be.set("anonymousUser",{accessLevel:h,followingRooms:[],objectId:"-1",isAnonymous:!0});var je="wallet",Oe="chat",Ee="worldMap",we=new Map;var Ie=Object(q.c)({users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"user"===t.type?pe(e,t):t.type===ue?ve(e,t):e},aliases:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"alias"===t.type?pe(e,t):t.type===X?ve(e,t):e},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"message"===t.type?pe(e,t):t.type===re?ve(e,t):e},online:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;if("online"===t.type){var n=t.payload,r=n.online;return r}return e},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"room"===t.type?pe(e,t):t.type===ae?ve(e,t):e},userId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-1",t=arguments.length>1?arguments[1]:void 0;if("userId"===t.type){var n=t.payload,r=n.reset,a=n.userId;return r?"-1":a}return e},positions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"position"===t.type?pe(e,t):"positions"===t.type?ve(e,t):e},transactions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"transaction"===t.type&&pe(e,t),t.type===ie?ve(e,t):e},wallets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return"wallet"===t.type&&pe(e,t),t.type===se?ve(e,t):e},config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;if("config"===t.type){var n=t.payload,r=n.entries,a=new Map(Object(le.a)(e));return r.forEach((function(e){return a.set(e[0],e[1])})),a}return e},aliasId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if("aliasId"===t.type){var n=t.payload,r=n.reset,a=n.userId;return r?null:a}return e},windowOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;if("windowOrder"===t.type){var n=t.payload,r=n.id,a=n.type,o=new Map(Object(le.a)(e));return o.size>0&&Object(le.a)(o.keys()).indexOf(r)===o.size-1?e:(o.delete(r),o.set(r,a),o)}if("windowOrders"===t.type){var c=t.payload,i=c.windows,u=new Map(Object(le.a)(e));return i.forEach((function(e){var t=e.id,n=e.type;return u.set(t,n)})),u}return e}}),ke=Object(q.d)(Ie,Object(q.a)(V.a)),Se="deviceId",Ce="token",Ne="userId",xe=function(e,t){"string"===typeof t?localStorage.setItem(e,t):localStorage.setItem(e,function(e){return JSON.stringify(e)}(t))},Ae=function(e){return localStorage.getItem(e)},Re=function(e){return localStorage.removeItem(e)},Te=function(){Re(Ce),Re(Ne)},Me=function(){return Ae(Se)},Le=function(){return Ae(Ce)},Pe=function(e){var t=e.userId,n=e.token;return xe(Ce,n),function(e){xe(Ne,e)}(t),{type:"userId",payload:{userId:t}}},De=function(){return Te(),function(e){e({type:"userId",payload:{reset:!0}}),e({type:"aliasId",payload:{reset:!0}})}},We=function(e){return e.online===ge},Fe=function(){return{type:"online",payload:{online:ge}}},Ue=function(e){return e.userId},Be=function(e){return function(e){return e.aliasId}(e)||Ue(e)},ze=function(e){var t=e.messages;return 1===t.length?{type:"message",payload:{changeType:me,message:t[0]}}:{type:re,payload:{messages:t,changeType:me}}},He="chatMsg",Ze="whisper",Ge=function(e){var t=e.users;return 1===t.length?{type:"user",payload:{user:t[0],changeType:de}}:{type:ue,payload:{users:t,changeType:de}}},Ye=function(e){var t=e.rooms;return 1===t.length?{type:"room",payload:{changeType:de,room:t[0]}}:{type:ae,payload:{rooms:t,changeType:me}}},Je=function(e){var t=e.rooms;return 1===t.length?{type:"room",payload:{changeType:fe,room:t[0]}}:{type:ae,payload:{rooms:t,changeType:fe}}},qe=function(e){var t=e.room,n=e.user;return function(e){Object(c.b)((function(){e(Ye({rooms:[t]})),e(Ge({users:[n]}))}))}},Ve="room",Xe="followRoom",Qe="user",Ke=function(){var e="undefined"!==typeof ioUri?ioUri:"/";return console.log(e),window.io(e,{forceNew:!0})}(),$e="createUser",_e="sendMessage",et="createRoom",tt="followRoom",nt="getMessagesByRoom",rt="removeRoom",at={ALIASES:"getAliases",USERS:"getUsers",MESSAGES:"getMessages",ROOMS:"getRooms",INVITATIONS:"getInvitations",DOCFILES:"getDocFiles",FORUMS:"getForums",FORUMPOSTS:"getForumPosts",FORUMTHREADS:"getForumThreads",GAMECODES:"getGameCodes",SIMPLEMSGS:"getSimpleMsgs",TEAMS:"getTeams",TRANSACTIONS:"getTransactions",WALLETS:"getWallets",DEVICES:"getDevices"},ot="login",ct="reconnect",it="startup",ut="disconnect",st=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.event,r=t.callback,Ke.on(n,(function(e){console.log(n,e),r(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lt=function(){ke.getState().online!==ye&&(Ke.disconnect(),Ke.connect())},dt=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",new Promise((function(e,r){var a=n;a.token=Le(),We(ke.getState())||lt(),Ke.emit(t,a,(function(t){var n=t.error,a=t.data;n?r(n):e(a)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();st({event:ct,callback:function(){Ue(ke.getState)&&dt("updateId",{}).then((function(){ke.dispatch(Fe())})).catch((function(e){console.log(e),ke.dispatch(De())}))}}),st({event:it,callback:function(e){var t,n=e.data,r=Ae(Ne),a=Le();r&&a&&ke.dispatch(Pe({userId:r,token:a})),Me()||xe(Se,"1234567890123456"),ke.dispatch((t=n,function(e){Object(c.b)((function(){e({type:"config",payload:{entries:Object.entries(t)}}),e(Fe())}))})),(r||a)&&dt("updateId",{}).then((function(){ke.dispatch(Fe())})).catch((function(e){console.log(e),ke.dispatch(De())}))}}),st({event:ut,callback:function(){ke.dispatch({type:"online",payload:{online:he}}),lt()}}),st({event:He,callback:function(e){var t=e.data,n=e.error;if(t&&t.message){var r=t.message;t.changeType===me&&ke.dispatch(ze({messages:[r]}))}else console.log(He,n,t)}}),st({event:Ze,callback:function(e){var t=e.data,n=e.error;if(t&&t.message){var r=t.message;t.changeType===me&&ke.dispatch(ze({messages:[r]}))}else console.log(Ze,n,t)}}),st({event:Ve,callback:function(e){var t=e.error,n=e.data;if(n&&n.room){var r=n.room,a=n.changeType;a===me?ke.dispatch(function(e){var t=e.rooms;return 1===t.length?{type:"room",payload:{changeType:me,room:t[0]}}:{type:ae,payload:{rooms:t,changeType:me}}}({rooms:[r]})):a===de?ke.dispatch(Ye({rooms:[r]})):a===fe&&ke.dispatch(Je({rooms:[r]}))}else console.log("Error",Ve,t,n)}}),st({event:Xe,callback:function(e){var t=e.error,n=e.data;n&&n.room&&n.user?ke.dispatch(function(){var e=Object(w.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(c.b)((function(){t(Ye({rooms:[n.room]})),t(Ge({users:[n.user]})),console.log(ke.getState())}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):console.log("Error",Xe,t,n)}}),st({event:Qe,callback:function(e){var t=e.data;if(t&&t.user){var n=t.user,r=t.changeType;console.log(t),r===me?ke.dispatch(function(e){var t=e.users;return 1===t.length?{type:"user",payload:{user:t[0],changeType:me}}:{type:ue,payload:{users:t,changeType:me}}}({users:[n]})):r===de&&ke.dispatch(Ge({users:[n]}))}}});var mt=function(){var e=Object(w.a)(E.a.mark((function e(t,n){var r,a,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dt(ot,{user:{username:t,password:n}});case 2:return r=e.sent,a=r.user,o=r.token,ke.dispatch(Pe({userId:a.objectId,token:o})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ft=function(){var e=Object(w.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ke.dispatch(De());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pt=function(e){var t=e.onChange,n=e.type,o=void 0===n?"text":n,c=e.required,u=void 0!==c&&c,s=e.placeholder,l=void 0===s?"":s,d=Object(r.useState)(!1),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(r.useState)(!1),g=Object(i.a)(v,2),h=g[0],y=g[1];return a.a.createElement("input",{type:o,defaultValue:"",className:"Input ".concat(h?"empty":""),onFocus:function(){return p(!0)},onBlur:function(e){f&&u&&y(""!==e.target.value)},onChange:function(e){return t(e.target.value)},placeholder:l})},vt=pt;pt.defaultProps={placeholder:"",required:!1,type:"text"};var gt=a.a.memo((function(e){var t=e.done,n=Object(r.useState)(""),o=Object(i.a)(n,2),c=o[0],u=o[1],s=Object(r.useState)(""),l=Object(i.a)(s,2),d=l[0],m=l[1],f=Object(r.useState)(),p=Object(i.a)(f,2),v=p[0],g=p[1],h=function(){var e=Object(w.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:mt(c,d).then((function(){t()})).catch((function(e){g(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(J,{classNames:["LoginDialog"],done:t,error:v,title:"Login"},a.a.createElement(vt,{placeholder:"Username",onChange:u}),a.a.createElement(vt,{placeholder:"Password",onChange:m,type:"password"}),a.a.createElement(z,{type:"submit",onClick:h},"Login"))})),ht=function(e){var t=e.onChange,n=e.children,o=e.required,c=void 0!==o&&o,u=e.placeholder,s=void 0===u?"":u,l=e.multiple,d=void 0!==l&&l,m=Object(r.useState)(!1),f=Object(i.a)(m,2),p=f[0],v=f[1],g=Object(r.useState)(!1),h=Object(i.a)(g,2),y=h[0],b=h[1],j=function(e){var t=Array.from(e.target.selectedOptions).filter((function(e){return""!==e.value}));p&&c&&b(0===t.length)};return a.a.createElement("select",{className:"Select ".concat(y?"empty":""),onFocus:function(){return v(!0)},onBlur:j,onChange:function(e){j(e),t(Array.from(e.target.selectedOptions).map((function(e){return e.value})).filter((function(e){return""!==e})))},placeholder:s,multiple:d},n)},yt=ht;ht.defaultProps={multiple:!1,children:void 0,placeholder:"",required:!1};var bt=function(e){var t=e.onChange,n=e.required,o=void 0!==n&&n,c=e.placeholder,u=void 0===c?"":c,s=Object(r.useState)(!1),l=Object(i.a)(s,2),d=l[0],m=l[1],f=Object(r.useState)(!1),p=Object(i.a)(f,2),v=p[0],g=p[1];return a.a.createElement("input",{defaultValue:"",className:v?"empty":"",onFocus:function(){return m(!0)},onBlur:function(e){var t=e.target.value.trim();d&&o&&g(""!==t)},onChange:function(e){return t(e.target.value)},placeholder:u})},jt=bt;bt.defaultProps={placeholder:"",required:!1};var Ot=function(){var e=Object(w.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t).user.registerDevice=Me(),e.abrupt("return",dt($e,n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Et=a.a.memo((function(e){var t=e.done,n=Object(r.useState)(),o=Object(i.a)(n,2),u=o[0],l=o[1],d=Object(r.useState)(),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(r.useState)(),g=Object(i.a)(v,2),h=g[0],y=g[1],b=Object(r.useState)(),j=Object(i.a)(b,2),O=j[0],I=j[1],k=Object(r.useState)(),S=Object(i.a)(k,2),C=S[0],N=S[1],x=Object(r.useState)(),A=Object(i.a)(x,2),R=A[0],T=A[1],M=Object(r.useState)(),L=Object(i.a)(M,2),P=L[0],D=(L[1],Object(r.useState)()),W=Object(i.a)(D,2),F=W[0],U=W[1],B=Object(c.d)(s),H=function(){var e=Object(w.a)(E.a.mark((function e(){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((!B||u)&&f&&h&&O&&R){e.next=2;break}return e.abrupt("return");case 2:if(h===O){e.next=4;break}return e.abrupt("return");case 4:return n={image:P,user:{offName:u,username:f,password:h,description:C,pronouns:R}},e.prev=5,e.next=8,Ot(n);case 8:return e.next=10,mt(f,h);case 10:t(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),U(e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(J,{error:F,done:t,title:"Register user"},B&&a.a.createElement(vt,{placeholder:"Out-of-game name",onChange:l}),a.a.createElement(vt,{placeholder:"Username",onChange:p}),a.a.createElement(yt,{multiple:!0,required:!0,onChange:T},a.a.createElement("option",{value:""},"---Choose pronouns---"),a.a.createElement("option",{value:"they"},"They/Them"),a.a.createElement("option",{value:"she"},"She/Her"),a.a.createElement("option",{value:"he"},"He/Him"),a.a.createElement("option",{value:"it"},"It")),a.a.createElement(vt,{placeholder:"Password",onChange:y,type:"password"}),a.a.createElement(vt,{placeholder:"Repeat password",onChange:I,type:"password"}),a.a.createElement(jt,{placeholder:"Description",onChange:N}),a.a.createElement("div",{className:"buttons"},a.a.createElement(z,{type:"submit",onClick:H},"Register")))})),wt=n(7),It=n(8),kt=n.n(It),St=function(e){return e.aliases},Ct=function(e){return e.users},Nt=function(e){return e.users.get(Ue(e))||function(e){return e.config.get("anonymousUser")}(e)},xt=Object(wt.createSelector)([Nt],(function(e){return e.accessLevel})),At=Object(wt.createSelector)([Ct,St],(function(e,t){return[].concat(Object(le.a)(e.values()),Object(le.a)(t.values()))})),Rt=kt()([Ct,St,function(e,t){return t.ids}],(function(e,t,n){var r=new Map;return n.forEach((function(n){return r.set(n,e.get(n)||t.get(n))})),r}))((function(e,t){var n=t.ids;return"identities-".concat(n.join(""))})),Tt=Object(wt.createSelector)([function(e,t){var n=t.id;return e.users.get(n)},function(e,t){var n=t.id;return e.aliases.get(n)}],(function(e,t){return e||t})),Mt=Object(wt.createSelector)([At,Ue],(function(e,t){return e.filter((function(e){return e.objectId!==t&&e.ownerId!==t&&!e.userIds.includes(t)}))})),Lt=Object(wt.createSelector)([At,Ue],(function(e,t){return e.filter((function(e){return e.objectId===t||e.ownerId===t||e.userIds.includes(t)}))})),Pt=function(e){return Object(o.createPortal)(e,document.querySelector("#MainWindow"))},Dt=function(e){var t=e.children,n=e.classNames,r=void 0===n?[]:n,o=e.onClick,c=void 0===o?function(){}:o;return a.a.createElement("li",{className:["ListItem"].concat(r).join(" "),onClick:c},t)},Wt=a.a.memo(Dt);function Ft(){return(Ft=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ut(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}Dt.defaultProps={onClick:function(){},classNames:[]};var Bt=a.a.createElement("line",{x1:3,y1:12,x2:21,y2:12}),zt=a.a.createElement("line",{x1:3,y1:6,x2:21,y2:6}),Ht=a.a.createElement("line",{x1:3,y1:18,x2:21,y2:18}),Zt=function(e){var t=e.svgRef,n=e.title,r=Ut(e,["svgRef","title"]);return a.a.createElement("svg",Ft({width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-menu",ref:t},r),n?a.a.createElement("title",null,n):null,Bt,zt,Ht)},Gt=a.a.forwardRef((function(e,t){return a.a.createElement(Zt,Ft({svgRef:t},e))})),Yt=(n.p,function(e){var t=e.onDialog,n=Object(c.d)(xt),r=[];return n===h&&r.push(a.a.createElement(Wt,{key:"register",onClick:function(){t(Pt(a.a.createElement(Et,{done:function(){return t()}})))}},"Create user"),a.a.createElement(Wt,{key:"login",onClick:function(){t(Pt(a.a.createElement(gt,{done:function(){return t()}})))}},"Login")),n>=y&&r.push(a.a.createElement(Wt,{key:"logout",onClick:function(){ft()}},"Logout")),a.a.createElement(g,{dropdown:!0,title:a.a.createElement(Gt,null)},r)});n(50);function Jt(){return(Jt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qt(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Vt=a.a.createElement("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}),Xt=function(e){var t=e.svgRef,n=e.title,r=qt(e,["svgRef","title"]);return a.a.createElement("svg",Jt({width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-message-square",ref:t},r),n?a.a.createElement("title",null,n):null,Vt)},Qt=a.a.forwardRef((function(e,t){return a.a.createElement(Xt,Jt({svgRef:t},e))}));n.p;function Kt(){return(Kt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function $t(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var _t=a.a.createElement("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),en=a.a.createElement("line",{x1:8,y1:2,x2:8,y2:18}),tn=a.a.createElement("line",{x1:16,y1:6,x2:16,y2:22}),nn=function(e){var t=e.svgRef,n=e.title,r=$t(e,["svgRef","title"]);return a.a.createElement("svg",Kt({width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-map",ref:t},r),n?a.a.createElement("title",null,n):null,_t,en,tn)},rn=a.a.forwardRef((function(e,t){return a.a.createElement(nn,Kt({svgRef:t},e))}));n.p;function an(){return(an=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function on(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var cn=a.a.createElement("rect",{x:1,y:4,width:22,height:16,rx:2,ry:2}),un=a.a.createElement("line",{x1:1,y1:10,x2:23,y2:10}),sn=function(e){var t=e.svgRef,n=e.title,r=on(e,["svgRef","title"]);return a.a.createElement("svg",an({width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-credit-card",ref:t},r),n?a.a.createElement("title",null,n):null,cn,un)},ln=a.a.forwardRef((function(e,t){return a.a.createElement(sn,an({svgRef:t},e))})),dn=(n.p,function(e){var t=e.windows;if(1===t.length){var n=Object(i.a)(t,1)[0],r=n.type;return{type:"windowOrder",payload:{id:n.id,type:r}}}return{type:"windowOrders",payload:{windows:t}}}),mn=a.a.memo((function(){var e=function(e){var t=e.id,n=e.type;return ke.dispatch(dn({windows:[{id:t,type:n}]}))};return a.a.createElement(g,{classNames:["OpenApps"]},a.a.createElement(Wt,{key:"wallet"},a.a.createElement(z,{onClick:function(){return e({id:je,type:je})}},a.a.createElement(ln,null))),a.a.createElement(Wt,{key:"map"},a.a.createElement(z,{onClick:function(){return e({id:Ee,type:Ee})}},a.a.createElement(rn,null))),a.a.createElement(Wt,{key:"chat"},a.a.createElement(z,{onClick:function(){return e({id:Oe,type:Oe})}},a.a.createElement(Qt,null))))})),fn=function(){var e=Object(r.useState)(),t=Object(i.a)(e,2),n=t[0],o=t[1],u=[],s=[];return Object(c.d)(We)||s.push("warning"),a.a.createElement("div",{className:"".concat(s.join(" ")),id:"MenuBar"},a.a.createElement(Yt,{onDialog:o}),a.a.createElement(mn,null),u,a.a.createElement(f,null),n)},pn=n(9),vn=function(){var e=Object(c.c)(),t=Object(c.d)(Ue);return Object(r.useEffect)((function(){!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.reset;[{type:ue,event:at.USERS},{type:X,event:at.ALIASES},{type:re,event:at.MESSAGES},{type:ae,event:at.ROOMS},{type:ne,event:at.INVITATIONS},{type:K,event:at.DOCFILES},{type:$,event:at.FORUMS},{type:_,event:at.FORUMPOSTS},{type:ee,event:at.FORUMTHREADS},{type:te,event:at.GAMECODES},{type:oe,event:at.SIMPLEMSGS},{type:ce,event:at.TEAMS},{type:ie,event:at.TRANSACTIONS},{type:se,event:at.WALLETS},{type:Q,event:at.DEVICES}].forEach(function(){var t=Object(w.a)(E.a.mark((function t(r){var a,o;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=r.event,o=r.type,dt(a,{}).then((function(t){e({type:o,payload:Object(pn.a)({reset:n,changeType:me},o,t[o])})})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}({reset:!0})}),[t]),a.a.createElement(a.a.Fragment,null)},gn=function(e,t){return e.wallets.get(t)},hn=Object(wt.createSelector)([function(e){return e.wallets},Nt],(function(e,t){return Object(le.a)(e.values()).filter((function(e){var n=e.ownerAliasId||e.ownerId;return n===t.objectId||t.aliases.includes(n)})).map((function(e){return e.objectId}))})),yn=function(e){return e.transactions},bn=function(e,t){return e.transaction.get(t)},jn=function(e,t){var n=bn(e,t),r=gn(e,n.toWalletId),a=gn(e,n.fromWalletId);return[a.ownerAliasId||a.ownerId,r.ownerAliasId||r.ownerId]},On=(Object(wt.createSelector)([yn,hn],(function(e,t){return Object(le.a)(e.values()).filter((function(e){var n=e.fromWalletId,r=e.toWalletId;return t.includes(n)||t.includes(r)})).map((function(e){return e.objectId}))})),a.a.memo((function(e){var t=e.transactionId,n=Object(c.d)((function(e){return bn(e,t)})),r=Object(c.d)((function(e){return jn(e,jn(e,t))})),o=Object(i.a)(r,2),u=o[0],s=o[1];return a.a.createElement(Wt,{classNames:["TransactionItem"],key:t},a.a.createElement("span",null,n.amount),a.a.createElement("span",null,u.aliasName||u.username),a.a.createElement("span",null,s.aliasName||s.username))}))),En=a.a.memo((function(e){var t=e.walletIds,n=Object(c.d)(function(e){return Object(wt.createSelector)([yn],(function(t){return Object(le.a)(t.values()).filter((function(t){var n=t.fromWalletId,r=t.toWalletId;return e.includes(n)||e.includes(r)})).map((function(e){return e.objectId}))}))}(t));return a.a.createElement(g,{large:!0,classNames:["TransactionList"]},n.map((function(e){return a.a.createElement(On,{transactionId:e})})))})),wn=a.a.memo((function(e){var t=e.id,n=Object(c.d)(hn),o=Object(r.useCallback)((function(){ke.dispatch(dn({windows:[{id:t,type:je}]}))}),[]);return a.a.createElement(G,{classNames:["Wallet"],title:"wallet",onClick:o},a.a.createElement(En,{walletIds:n}))})),In=(n(51),function(){var e=Object(r.useState)(),t=Object(i.a)(e,2),n=(t[0],t[1]),o=Object(r.useRef)();return Object(r.useEffect)((function(){!function e(){if("undefined"!==typeof window.google&&"undefined"!==typeof window.MarkerClusterer&&"undefined"!==typeof window.MapLabel){var t=new window.google.maps.Map(o.current,{disableDefaultUI:!0,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,noClear:!0,zoomControl:!1,panControl:!1,overviewMapControl:!1,rotateControl:!1,scaleControl:!1,streetViewControl:!1,center:{lat:-34.397,lng:150.644},zoom:8,styles:[{elementType:"geometry",stylers:[{color:"#13002d"}]},{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"administrative",stylers:[{color:"#370087"}]},{featureType:"landscape.natural.terrain",stylers:[{color:"#44003a"}]},{featureType:"road",stylers:[{color:"#6e6c6d"},{weight:.5}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:"#7d006c"}]}]});n(t)}else setTimeout(e,1e3)}()}),[]),a.a.createElement("div",{ref:o,className:"MapView"})}),kn=function(e){return e.positions},Sn=function(e){return Object(wt.createSelector)([kn],(function(t){return Object(le.a)(t.values()).filter((function(t){var n=t.positionType;return e===n})).map((function(e){return{positionName:e.positionName,objectId:e.objectId}}))}))},Cn=function(e){var t=e.title,n=e.positionType,o=Object(r.useMemo)(Sn,[]),i=Object(c.d)((function(e){return o(e,n)}));return a.a.createElement("div",{key:"positionsList",className:"PositionsList"},a.a.createElement(g,{title:t},i.map((function(e){return a.a.createElement(Wt,{key:e.objectId,onClick:function(){console.log(e.objectId)}},e.positionName)}))))},Nn=a.a.memo(Cn);Cn.defaultProps={title:void 0};var xn=function(e){var t=e.positionTypes,n=void 0===t?[]:t;return a.a.createElement("div",{className:"lists Positions"},n.map((function(e){return a.a.createElement(Nn,{title:e,positionType:e})})))},An=(n(52),a.a.memo((function(e){var t=e.id,n=Object(r.useCallback)((function(){ke.dispatch(dn({windows:[{id:t,type:Ee}]}))}),[]);return a.a.createElement(G,{classNames:["WorldMap"],title:"map",onClick:n,menu:a.a.createElement(a.a.Fragment,null,a.a.createElement(xn,null))},a.a.createElement(In,null))}))),Rn=function(e){return e.rooms},Tn=function(e,t){var n=t.id;return e.rooms.get(n)},Mn=kt()([Rn],(function(e){return Object(le.a)(e.values()).filter((function(e){return!e.isWhisper&&!e.isUser}))}))((function(){return"normalRooms"})),Ln=kt()([Rn],(function(e){return Object(le.a)(e.values()).filter((function(e){return e.isWhisper})).map((function(e){return{objectId:e.objectId,participantIds:e.participantIds}}))}))((function(){return"whisperRooms"})),Pn=kt()([Mn,Nt],(function(e,t){return e.filter((function(e){return!t.followingRooms.includes(e.objectId)})).map((function(e){return{roomName:e.roomName,objectId:e.objectId}})).sort((function(e,t){var n=e.roomName.toLowerCase(),r=t.roomName.toLowerCase();return n>r||r<n?1:0})).map((function(e){return e.objectId}))}))((function(){return"unfollowedRooms"})),Dn=kt()([Mn,Nt],(function(e,t){return e.filter((function(e){return t.followingRooms.includes(e.objectId)})).map((function(e){return e.objectId}))}))((function(){return"followedRooms"})),Wn=kt()([Ln,function(e,t){return{identityId:t.identityId,currentIdentityId:t.currentIdentityId}}],(function(e,t){var n=t.currentIdentityId,r=t.identityId;return e.find((function(e){return e.participantIds.includes(n)&&e.participantIds.includes(r)}))}))((function(e,t){var n=t.currentIdentityId,r=t.identityId;return"whisper-".concat(n,"-").concat(r)})),Fn=kt()([Rt,Lt,function(e,t){return t.ids}],(function(e,t,n){var r=e.get(n[0]),a=e.get(n[1]);return t.find((function(e){var t=e.objectId;return r.objectId===t||r.ownerId===t||r.userIds.includes(t)}))?"".concat(r.username||r.aliasName," > ").concat(a.username||r.aliasName):"".concat(a.username||r.aliasName," > ").concat(r.username||r.aliasName)}))((function(e,t){var n=t.ids;return"w-name-".concat(n.join(" "))})),Un=a.a.memo((function(e){var t=e.identityId,n=e.done,r=(Object(c.d)((function(e){return Tt(e,{id:t})})),Object(c.d)(Be));return a.a.createElement(J,{done:n},a.a.createElement(z,{type:"button",onClick:function(){var e=Wn(ke.getState(),{identityId:t,currentIdentityId:r})||Tn(ke.getState(),{id:t});n({roomId:e.objectId})}},"Message"))})),Bn=a.a.memo((function(e){var t=e.onDialog,n=e.onDone,r=Object(c.d)(Mt);return a.a.createElement(g,{dropdown:!0,classNames:["UserList"],title:"Users"},r.map((function(e){return a.a.createElement(Wt,{key:e.objectId,onClick:function(){t(Pt(a.a.createElement(Un,{done:function(e){n(e),t()},identityId:e.objectId})))}},e.username||e.aliasName)})))})),zn="chat",Hn="whisper",Zn=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r,a,o,c,i,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.text,r=t.roomId,a=t.image,o=Tn(ke.getState(),{id:r}),c=o.isWhisper?o.participantIds:[],i={roomId:r,text:n.split("\n")},o.isUser?(i.messageType=Hn,c.push(Be(ke.getState())),c.push(r)):o.isWhisper?i.messageType=Hn:i.messageType=zn,e.next=7,dt(_e,{message:i,image:a,participantIds:c});case 7:return u=e.sent,ke.dispatch(ze({messages:[u.message]})),e.abrupt("return",{message:u.message,switchRoom:!0});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gn=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roomId,e.next=3,dt(nt,{roomId:n});case 3:return r=e.sent,ke.dispatch(ze({messages:r.messages})),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yn=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.room,e.next=3,dt(et,{room:n});case 3:return r=e.sent,e.next=6,ke.dispatch(qe({room:r.room,user:r.user}));case 6:return e.abrupt("return",{room:r.room});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Jn=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roomId,r=t.password,e.next=3,dt(tt,{roomId:n,password:r});case 3:return a=e.sent,e.next=6,Gn({roomId:n});case 6:return e.next=8,ke.dispatch(qe({room:a.room,user:a.user}));case 8:return e.abrupt("return",{room:a.room,user:a.user});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qn=function(){var e=Object(w.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roomId,e.next=3,dt(rt,{roomId:n});case 3:return r=e.sent,e.next=6,ke.dispatch(Je({rooms:[{objectId:n}]}));case 6:return e.abrupt("return",{room:r.room});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vn=a.a.memo((function(e){var t=e.roomId,n=e.onChange,r=Object(c.d)((function(e){return Tn(e,{id:t})}));return a.a.createElement(Wt,{key:t,onClick:function(){Jn({roomId:r.objectId}).then((function(){return n({roomId:r.objectId})})).catch((function(e){return console.log(e)}))}},r.roomName)})),Xn=a.a.memo((function(e){var t=e.onChange,n=Object(c.d)(Pn);return a.a.createElement(g,{dropdown:!0,key:"roomList",classNames:["RoomList"],title:"Rooms"},n.map((function(e){return a.a.createElement(Vn,{key:e,roomId:e,onChange:t})})))})),Qn=a.a.memo((function(e){var t=e.room,n=e.onChange,r=Object(c.d)((function(e){return Fn(e,{ids:t.participantIds})}));return a.a.createElement(Wt,{key:t.objectId,onClick:function(){n({roomId:t.objectId,roomName:r})}},r)})),Kn=a.a.memo((function(e){var t=e.onChange,n=Object(c.d)(Ln);return a.a.createElement(g,{dropdown:!0,key:"whisperList",classNames:["WhisperList"],title:"PM"},n.map((function(e){return a.a.createElement(Qn,{key:e.objectId,room:e,onChange:t})})))})),$n=a.a.memo((function(e){var t=e.roomId,n=e.onChange,r=Object(c.d)((function(e){return Tn(e,{id:t})}));return a.a.createElement(Wt,{key:t,onClick:function(){n({roomId:t})}},r.roomName)})),_n=a.a.memo((function(e){var t=e.onChange,n=Object(c.d)(Dn);return a.a.createElement(g,{dropdown:!0,key:"followingList",classNames:["FollowingList"],title:"Joined"},n.map((function(e){return a.a.createElement($n,{key:e,roomId:e,onChange:t})})))})),er=a.a.memo((function(e){var t=e.onChange,n=e.onDialog,r=Object(c.d)(xt);return a.a.createElement(a.a.Fragment,null,r>=y&&a.a.createElement(a.a.Fragment,null,a.a.createElement(_n,{key:"following",onChange:t}),a.a.createElement(Kn,{key:"whisper",onChange:t}),a.a.createElement(Xn,{key:"room",onChange:t,onDialog:n})),a.a.createElement(Bn,{onDone:t,onDialog:n,key:"user"}))})),tr=n(29),nr=a.a.forwardRef((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.image,n=e.onRemove,r=e.classNames,o=void 0===r?[]:r,c=e.altText,i=void 0===c?"":c,u=arguments.length>1?arguments[1]:void 0;return a.a.createElement("div",{className:"".concat(["Image"].concat(o).join(" "))},n&&a.a.createElement("div",{role:"complementary",onClick:function(e){e.stopPropagation(),n()}},"X"),a.a.createElement("img",{ref:u,src:t,alt:i}))})),rr=nr;nr.propTypes={image:U.string.isRequired,altText:U.string,classNames:Object(U.arrayOf)(U.string),onRemove:U.func},nr.defaultProps={altText:"",classNames:[],onRemove:void 0};var ar=n(27),or=n.n(ar),cr=(n(53),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onChange,n=Object(r.useRef)(null),o=Object(r.useRef)(null),c=Object(r.useState)(),u=Object(i.a)(c,2),s=u[0],l=u[1];Object(r.useEffect)((function(){t(s)}),[s]);var d=function(e){var t=(e.target.files||[])[0];if(t){var n=new FileReader;n.addEventListener("load",(function(){n.result&&l({imageName:t.name,source:n.result,width:o.current.naturalWidth,height:o.current.naturalHeight})})),n.readAsDataURL(t)}};return a.a.createElement("div",{className:"ImageUpload"},a.a.createElement("input",{key:"uploadInput",className:"hide",ref:n,type:"file",accept:"image/png, image/jpeg, image/pjpeg",onChange:d}),a.a.createElement(z,{type:"button",onClick:function(){n.current.click()}},a.a.createElement(rr,{onRemove:function(){return l()},ref:o,classNames:["previewImage"].concat([s?"":"hide"]),image:s?s.source:"",altText:"Image preview"}),a.a.createElement(rr,{image:or.a,altText:"Upload image"})))}),ir=a.a.memo(cr);cr.defaultProps={};n(54);var ur=function(e){var t=e.roomId,n=e.onSend,o=e.minAccessLevel,u=void 0===o?y:o,s=Object(tr.a)(),l=s.register,m=s.handleSubmit,f=s.reset,p=Object(r.useRef)(null),v=Object(r.useRef)(null),g=Object(r.useState)(),h=Object(i.a)(g,2),b=h[0],j=h[1],O=Object(c.d)(We),E=Object(c.d)(xt),w=Object(c.d)(d),I=function(){if(p.current){var e=p.current;e.style.height&&e.scrollHeight.toString()===e.style.height.split("px")[0]||(e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px"),p.current.scrollIntoView())}};return a.a.createElement("div",{className:"InputArea"},a.a.createElement("form",{onSubmit:m((function(e){var r=e.text;Zn({roomId:t,image:b,text:r}).then((function(e){var t=e.message,r=e.switchRoom;b&&j(void 0),f(),I(),r&&n({roomId:t.roomId})})).catch((function(e){console.log(e)}))}))},E>=u&&a.a.createElement("div",{key:"buttonBox",className:"buttonBox"},w.CHAT&&a.a.createElement(ir,{onChange:j})),a.a.createElement("div",{className:"input"},a.a.createElement("textarea",{name:"text",key:"input",rows:1,ref:function(e){l(e),p.current=e},onKeyDown:function(e){var t=e.key;e.altKey&&"Enter"===t&&v.current&&v.current.click()},placeholder:O?"Alt+Enter to send message":"Offline. Reconnecting to server...",className:[].join(" "),onChange:function(e){return I(e.target)}}),a.a.createElement(z,{ref:v,disabled:!O,key:"send",type:"submit",classNames:["sendButton"],onClick:function(){}},"Send"))))},sr=a.a.memo(ur);ur.defaultProps={minAccessLevel:y};var lr=kt()([function(e){return e.messages},function(e,t){return t.roomId}],(function(e,t){return Object(le.a)(e.values()).filter((function(e){return e.roomId===t}))}))((function(e,t){return t.roomId})),dr=kt()([lr],(function(e){return e.map((function(e){return e.objectId}))}))((function(e,t){var n=t.roomId;return"id-".concat(n)})),mr=(n(55),a.a.memo((function(e){var t=e.identityId,n=e.timeCreated,r=e.onDialog,o=Object(c.d)((function(e){return Tt(e,{id:t})})),i=Object(c.d)((function(e){return m(e,{date:n})}));return a.a.createElement("p",{className:"MessageInfo"},a.a.createElement("span",{role:"button",tabIndex:0,className:"clickable username",onClick:function(){o&&r(Pt(a.a.createElement(Un,{identityId:o.objectId,done:function(){return r()}})))}},o?o.username||o.aliasName:"-"),a.a.createElement("span",{className:"time"},i.fullStamp))}))),fr=(n(56),a.a.memo((function(e){var t=e.messageId,n=e.onDialog,r=Object(c.d)((function(e){return function(e,t){var n=t.id;return e.messages.get(n)}(e,{id:t})}));return a.a.createElement(Wt,{classNames:["MessageItem"],key:t},a.a.createElement(mr,{identityId:r.ownerAliasId||r.ownerId,timeCreated:r.customTimeCreated||r.timeCreated,onDialog:n}),a.a.createElement("div",{className:"text"},r.text.map((function(e,t){return a.a.createElement("p",{key:t},e)}))))}))),pr=(n(57),function(e){var t=e.roomId,n=e.onDialog,r=Object(c.d)((function(e){return dr(e,{roomId:t})}));return a.a.createElement(g,{large:!0,scrollTo:{buffer:!0,direction:"bottom"},classNames:["MessageList"]},r.map((function(e){return a.a.createElement(fr,{key:e,messageId:e,onDialog:n})})))}),vr=a.a.memo(pr);pr.defaultProps={roomId:void 0};n(58);var gr=function(e){var t=e.roomId,n=e.onDialog,r=e.onSend,o=Object(c.d)(xt);return a.a.createElement("div",{className:"Messages"},a.a.createElement("div",{className:"spacer"}),a.a.createElement(vr,{key:"messagesList",roomId:t,onDialog:n}),o>=y&&a.a.createElement(sr,{onSend:r,roomId:t,key:"inputArea"}))},hr=a.a.memo(gr);gr.defaultProps={roomId:void 0};var yr=a.a.memo((function(e){var t=e.children;return a.a.createElement(g,{dropdown:!0,classNames:["FileMenu"],title:"File"},t,a.a.createElement(Wt,{key:"quit",onClick:function(){console.log("quit")}},"Quit"))})),br=a.a.memo((function(e){var t=e.done,n=Object(r.useState)(),o=Object(i.a)(n,2),c=o[0],u=o[1],s=Object(r.useState)(),l=Object(i.a)(s,2),d=l[0],m=l[1],f=Object(r.useState)(),p=Object(i.a)(f,2),v=p[0],g=p[1],h=Object(r.useState)(),y=Object(i.a)(h,2),b=y[0],j=y[1],O=Object(r.useState)(),E=Object(i.a)(O,2),w=E[0],I=E[1];return a.a.createElement(J,{classNames:["CreateRoomDialog"],done:t,error:w,title:"New room"},a.a.createElement(vt,{required:!0,onChange:u,placeholder:"Name of the room"}),a.a.createElement(vt,{onChange:j,placeholder:"Topic (shown when joining the room)"}),a.a.createElement(vt,{onChange:m,type:"password",placeholder:"Password"}),a.a.createElement(vt,{onChange:g,type:"password",placeholder:"Repeat password"}),a.a.createElement("div",{className:"buttons"},a.a.createElement(z,{type:"submit",onClick:function(){c&&(d&&d!==v||Yn({room:{roomName:c,password:d,topic:b}}).then((function(e){var n=e.newRoom;return t({roomId:n.objectId})})).catch((function(e){return I(e)})))}},"Create")))})),jr=a.a.memo((function(e){var t=e.done,n=e.roomId,o=Object(r.useState)(),u=Object(i.a)(o,2),s=u[0],l=u[1],d=Object(c.d)((function(e){return Tn(e,{id:n})}));return a.a.createElement(J,{classNames:["RemoveRoomDialog"],error:s,done:t,title:"Delete room ".concat(d?d.roomName:""),text:"Are you sure you want to delete ".concat(d?d.roomName:"","?")},a.a.createElement(z,{type:"button",onClick:function(){return t()}},"No"),a.a.createElement(z,{type:"button",onClick:function(){qn({roomId:n}).then((function(){return t()})).catch((function(e){return l(e)}))}},"Yes"))})),Or=(n(59),a.a.memo((function(e){var t=e.id,n=Object(r.useState)(),o=Object(i.a)(n,2),u=o[0],s=o[1],d=Object(r.useState)(l(ke.getState())),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(c.d)((function(e){return Tn(e,{id:f})})),g=Object(c.d)(Nt);Object(r.useEffect)((function(){g&&!g.isAnonymous&&v||f===l(ke.getState())||p(l(ke.getState()))}),[v,g]);var h=function(){if(!v)return"Chat";if(v.isUser){var e=Tt(ke.getState(),{id:f});return"PM: ".concat(e.aliasName||e.username)}return v.isWhisper?"PM: ".concat(Fn(ke.getState(),{ids:v.participantIds})):"Chat: ".concat(v.roomName)}(),y=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.roomId;t&&p(t)}),[]),b=Object(r.useCallback)(s,[]),O=Object(r.useCallback)((function(){return s(Pt(a.a.createElement(br,{done:function(e){var t=e.roomId;s(),t&&p(t)}})))}),[]),E=Object(r.useCallback)((function(){return s(Pt(a.a.createElement(jr,{roomId:f,done:function(){return s()}})))}),[f]),w=Object(r.useCallback)((function(){ke.dispatch(dn({windows:[{id:t,type:Oe}]}))}),[]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(G,{classNames:["Chat"],title:h,onClick:w,menu:a.a.createElement(a.a.Fragment,null,a.a.createElement(yr,{key:"fileMenu"},a.a.createElement(Wt,{key:"createRoom",onClick:O},"New room"),j({objectToAccess:v,toAuth:g}).hasFullAccess&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Wt,{key:"configRoom",onClick:function(){return s(Pt(a.a.createElement(jr,{roomId:f,done:function(){return s()}})))}},"Config room"),a.a.createElement(Wt,{key:"removeRoom",onClick:E},"Delete room"))),a.a.createElement(er,{key:"rooms",onChange:y,onDialog:b}))},a.a.createElement(hr,{key:"messages",roomId:f,onDialog:b,onSend:y})),u)}))),Er=function(e){return e.windowOrder},wr=(kt()([Er,function(e,t){return t.id}],(function(e,t){return Object(le.a)(e.keys()).indexOf(t)}))((function(e,t){var n=t.id;return"index-".concat(n)})),n(60),a.a.memo((function(){var e=Object(c.d)(Er),t=[];return console.log(e),e.forEach((function(e,n){e===Oe?t.push(a.a.createElement(Or,{key:n,id:n})):e===je?t.push(a.a.createElement(wn,{key:n,id:n})):e===Ee&&t.push(a.a.createElement(An,{key:n,id:n}))})),a.a.createElement("div",{id:"MainWindow"},t)})));var Ir=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(vn,null),a.a.createElement(fn,null),a.a.createElement(wr,null))},kr=(n(61),n(62));Object(o.render)(a.a.createElement(c.a,{store:ke},a.a.createElement(Ir,null)),document.getElementById("root")),kr.ElementQueries.listen()}},[[30,1,2]]]);
//# sourceMappingURL=main.c82bfb18.chunk.js.map